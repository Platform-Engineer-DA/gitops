apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: dev

resources: 
  - ../../base 

images:  
  - name: marcoscianci/gitops
    newTag: dev_placeholder

namePrefix: gitops-
nameSuffix: -dev
labels:
  - pairs:
      app: gitops          # <-- novo valor (antes era "myapp")
      app.kubernetes.io/name: gitops  # (opcional) padroniza label canonical
    includeSelectors: true
    includeTemplates: true
    

patches:
  - path: patch-host.yml   
  - target:
      kind: Rollout
      name: "gitops-rollout-dev"
    patch: |-
      - op: replace
        path: /spec/selector/matchLabels/app
        value: gitops
      - op: replace
        path: /spec/template/metadata/labels/app
        value: gitops

configurations: 
  - kustomize-nameref-rollouts.yml

